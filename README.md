# MoveItem.ps1
Windowsのフォルダにある写真と動画を日時で仕分けするPowerShellスクリプト

----
### 設定
1. `MoveItem.ps1` ファイルをメモ帳で開き、仕分け前フォルダと仕分け後フォルダを指定する。
1. ログファイルを出力するかどうかを指定する。
1. ログファイルの出力場所と出力ファイル名を指定する。
1. `MoveItem.ps1` のファイル名をわかりやすいものに変更する。
1. タスクスケジューラを設定する。
    1. Windows画面下部の検索バーで「タスクスケジューラ」と検索し実行する。
    1. 右側のメニューから「基本タスクの作成」をクリックする。
    1. 名前と説明を適当に入力する。
       ```
       例
       名前：MoveItem-Picture
       説明：C:\Users\UserName\Pictures\UploadからC:\Users\UserName\Picturesへ写真と動画を仕分けして移動する
       ```
    1. トリガーを設定する。
    1. 操作→「プログラムの開始」を選択する。
    1. プログラム/スクリプトに以下を指定する。

       `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe`
    1. 引数の追加に以下を指定する。`MoveItem.ps1` は自分で変更したファイル名を指定する。

       `-Command "MoveItem.ps1"`
    1. 開始に `MoveItem.ps1` が存在するディレクトリを指定する。

### 使い方
1. 仕分け前フォルダに写真と動画を入れる。
1. タスクスケジューラで設定した実行時間まで待つ。またはタスクスケジューラの実行ボタンで強制的に実行する。

### 仕様
* ファイルの「作成日時」「更新日時」「撮影日時」「メディアの作成日時」から、最も古い日時を取得して仕分けを行う。
* 仕分け前フォルダにサブフォルダがあると、その中身まで移動させる。
* 対応する写真ファイルと動画ファイルは以下の通り

|              | 拡張子(大文字を含む)                        |
| ------------ | ------------------------------------------- |
| 写真ファイル | `.jpg` `.jpeg` `.png` `.gif` `.bmp` `.heic` |
| 動画ファイル | `.mp4` `.mov` `.avi` `.wmv` `.flv` `.mkv`   |
* 他の拡張子のファイルやサブフォルダは移動されず、仕分け前のフォルダに残る。
* ログを消去する場合はログファイルごと消してよい。
* Windowsの仕様で、仕分け前のフォルダにファイルを「コピー」すると作成日時が現在の日付になる。「移動」なら作成日時は保持される。

----
### GitHub
https://github.com/cyan5/MoveItem

### 参考にしたサイト
https://www.k-hitorigoto.online/entry/2017/03/15/235348
https://github.com/t-asano/media-dater
